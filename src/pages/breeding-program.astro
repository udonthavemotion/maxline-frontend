---
import Layout from "@/layouts/Layout.astro";
import BreedingHero from "@/components/BreedingHero.astro";
import { getBreedingProgram, formatRichText, getImageUrl, isVideo, type BreedingProgram } from "@/lib/strapi";

// Fetch breeding program data from Strapi with proper populate parameters
let breedingProgram: BreedingProgram | null = null;
let error: string | null = null;

try {
  const response = await getBreedingProgram();
  breedingProgram = response.data;
  
  // üîç ENHANCED DEBUG: Let's see exactly what Strapi is returning
  console.log('‚úÖ Breeding program loaded from Strapi');
  console.log('üìã COMPLETE Raw response data:', JSON.stringify(response, null, 2));
  console.log('üîç Available fields in data:', Object.keys(breedingProgram || {}));
  
  // Check for ALL possible field variations
  const allPossibleFields = Object.keys(breedingProgram || {}).filter(key => 
    key.toLowerCase().includes('featured') || key.toLowerCase().includes('image')
  );
  console.log('üéØ All fields containing "featured" or "image":', allPossibleFields);
  
} catch (err) {
  console.error('‚ö†Ô∏è Using fallback content:', err);
  error = 'Using beautiful fallback content. Please configure your Strapi URL in .env';
  
  // Enhanced fallback data using the same structure as the strapi library
  breedingProgram = {
    id: 1,
    documentId: "fallback",
    title: 'MAX LINE BULLDOGS',
    subtext: 'WHERE LEGENDS ARE MADE üèÜ',
    description: 'Pioneering premium English Bulldog breeding through strategic imports, exotic genetics, and cultural influence. Our bloodlines represent the finest examples of champion heritage. üë®‚Äçü¶∫',
    partnership_note: 'In partnership with HorrorBulz HQ ü§ù',
    hero_media: [],
    Featured_IMAGE: undefined,
    photo_gallery: [],
    description_long: 'Our breeding program represents decades of dedication to the English Bulldog breed. We combine traditional breeding methods with modern genetic science to produce healthy, well-tempered bulldogs that embody the best of the breed standard. Each breeding decision is carefully planned, considering health clearances, temperament, conformation, and genetic diversity. üéØ',
    // Partnership fields with fallback values
    partnership_gallery_title: 'üíÄ HORRORBULLZHQ Gallery üíÄ',
    partnership_gallery_description: [],
    partnership_featured_title: 'üíÄ Featured: HORRORBULLZHQ Champion üíÄ',
    partnership_highlights_title: 'üíÄ Gallery Highlights üíÄ',
    partnership_highlights_description: 'Discover the dark beauty, personality, and excellence that defines our HorrorBullzHQ family',
    partnership_legacy_title: 'Our HorrorBullz Legacy',
    partnership_legacy_description: [],
    partnership_brand_name: 'HORRORBULLZHQ',
    partnership_theme_enabled: true,
    partnership_featured_main_title: 'MAX LINE BULLDOGS',
    partnership_featured_brand_line: '√ó HORRORBULLZ √ó',
    partnership_featured_tagline: '"Where Legends Are Made"',
    partnership_coming_soon_message: 'üíÄ More HorrorBullz Coming Soon üíÄ',
    createdAt: new Date().toISOString(),
    updatedAt: new Date().toISOString(),
    publishedAt: new Date().toISOString(),
  };
}

// Helper function to process rich text content properly
function processRichText(content: string | any[] | undefined): string {
  if (!content) return '';
  if (typeof content === 'string') return content;
  if (Array.isArray(content)) {
    return formatRichText(content);
  }
  return '';
}

// Helper function to safely get media arrays with null checking
function getMediaArray(mediaField: any[] | undefined): any[] {
  return Array.isArray(mediaField) ? mediaField : [];
}

// Get the hero media for background (can be image or video) - FIXED: hero_media is an array
const heroMediaArray = getMediaArray(breedingProgram?.hero_media);
const heroMedia = heroMediaArray.length > 0 ? heroMediaArray[0] : null;
const backgroundVideo = heroMedia && isVideo(heroMedia) ? heroMedia : null;
const backgroundImage = heroMedia && !isVideo(heroMedia) ? heroMedia : null;

// üéØ FIXED: Get the dedicated featured image (separate from gallery)
// Featured_IMAGE can be either a single object or array depending on Strapi config
const featuredImageRaw = breedingProgram?.Featured_IMAGE;
// Handle both single object and array cases - take first element if array
const featuredImage = Array.isArray(featuredImageRaw) && featuredImageRaw.length > 0 
  ? featuredImageRaw[0] 
  : !Array.isArray(featuredImageRaw) && featuredImageRaw 
    ? featuredImageRaw 
    : undefined;

console.log('üéØ Featured Image Debug:', {
  hasFeatureImage: !!featuredImage,
  featuredImageRaw: featuredImageRaw,
  featuredImageUrl: featuredImage ? getImageUrl(featuredImage, 'large') : 'none',
  featuredImageAlt: featuredImage?.alternativeText || 'Featured bulldog',
  isArray: Array.isArray(featuredImageRaw)
});

// Get all images from photo_gallery for the gallery (now separate from featured image)
const galleryImages = getMediaArray(breedingProgram?.photo_gallery);

// Enhanced video URL handling with debugging
let videoUrl = '';
let videoPosterUrl = '';
let videoPreviewUrl = '';

if (backgroundVideo) {
  videoUrl = backgroundVideo.url || '';
  videoPosterUrl = backgroundVideo.previewUrl || backgroundVideo.url.replace('.mp4', '.jpg') || '/hero-video-poster/horrorbullzhq_1750528212_3660018381867734658_54079664260.jpg';
  videoPreviewUrl = backgroundVideo.previewUrl || '';
  
  console.log('üé• Video debugging info:', {
    hasVideo: !!backgroundVideo,
    videoUrl,
    videoPosterUrl,
    videoPreviewUrl,
    videoMime: backgroundVideo.mime,
    videoSize: backgroundVideo.size
  });
}

// Fallback poster image for video or when no video is available
const fallbackPosterUrl = backgroundImage ? getImageUrl(backgroundImage, 'large') : 
  '/hero-video-poster/horrorbullzhq_1750528212_3660018381867734658_54079664260.jpg';

// üéØ MASONRY GALLERY OPTIMIZATION: Prepare gallery data with height variations
const masonryGalleryItems = galleryImages.map((image, index) => {
  // Create natural height variations for masonry effect
  const heightVariations = [
    'h-64', 'h-72', 'h-80', 'h-96', 'h-[22rem]', 'h-[26rem]'
  ];
  const cardHeight = heightVariations[index % heightVariations.length];
  
  return {
    ...image,
    cardHeight,
    priority: index < 4 ? 'high' : 'normal' // First 4 images get priority loading
  };
});

// üéØ Get partnership fields with proper fallbacks
const partnershipThemeEnabled = breedingProgram?.partnership_theme_enabled ?? true;
const partnershipBrandName = breedingProgram?.partnership_brand_name || 'HORRORBULLZHQ';
const partnershipGalleryTitle = breedingProgram?.partnership_gallery_title || 'üíÄ HORRORBULLZHQ Gallery üíÄ';
const partnershipGalleryDescription = processRichText(breedingProgram?.partnership_gallery_description) || 
  'Meet the legendary HorrorBullz - our exceptional English Bulldogs that embody strength, character, and championship bloodlines. Each photo showcases the dedication, quality, and excellence that defines our breeding program.';
const partnershipFeaturedTitle = breedingProgram?.partnership_featured_title || 'üíÄ Featured: HORRORBULLZHQ Champion üíÄ';
const partnershipHighlightsTitle = breedingProgram?.partnership_highlights_title || 'üíÄ Gallery Highlights üíÄ';
const partnershipHighlightsDescription = breedingProgram?.partnership_highlights_description || 
  'Discover the dark beauty, personality, and excellence that defines our HorrorBullzHQ family';
const partnershipLegacyTitle = breedingProgram?.partnership_legacy_title || 'Our HorrorBullz Legacy';
const partnershipLegacyDescription = processRichText(breedingProgram?.partnership_legacy_description) ||
  'Every photo in our gallery represents more than just legendary bulldogs ‚Äì they showcase our commitment to raising powerful, well-socialized companions with exceptional temperaments and champion bloodlines that define the HorrorBullzHQ standard.';
const partnershipFeaturedMainTitle = breedingProgram?.partnership_featured_main_title || 'MAX LINE BULLDOGS';
const partnershipFeaturedBrandLine = breedingProgram?.partnership_featured_brand_line || '√ó HORRORBULLZ √ó';
const partnershipFeaturedTagline = breedingProgram?.partnership_featured_tagline || '"Where Legends Are Made"';
const partnershipComingSoonMessage = breedingProgram?.partnership_coming_soon_message || 'üíÄ More HorrorBullz Coming Soon üíÄ';
---

<Layout title="Breeding Program | Max Line Bulldogs">
  <!-- 2025 AESTHETIC: Enhanced gradient background with organic flow -->
  <main class="bg-gradient-to-b from-[#F9F7F4] via-[#FDF9F5] to-[#F5F0E8] relative overflow-hidden">
    
    <!-- Organic Wave Divider -->
    <div class="absolute top-0 left-0 w-full h-32 overflow-hidden">
      <svg viewBox="0 0 1440 120" class="w-full h-full fill-gradient-to-r from-orange-100/30 to-blue-100/20">
        <path d="M0,64L48,69.3C96,75,192,85,288,80C384,75,480,53,576,48C672,43,768,53,864,69.3C960,85,1056,107,1152,101.3C1248,96,1344,64,1392,48L1440,32L1440,0L1392,0C1344,0,1248,0,1152,0C1056,0,960,0,864,0C768,0,672,0,576,0C480,0,384,0,288,0C192,0,96,0,48,0L0,0Z" fill="url(#wave-gradient)"></path>
        <defs>
          <linearGradient id="wave-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" style="stop-color:#fed7aa;stop-opacity:0.3" />
            <stop offset="100%" style="stop-color:#dbeafe;stop-opacity:0.2" />
          </linearGradient>
        </defs>
      </svg>
    </div>
    
    <!-- üéØ ENHANCED HERO SECTION - More cinematic at 85vh -->
    <section class="relative h-[85vh] flex items-center justify-center overflow-hidden">
      
      <!-- Clean Logo - Top Left (Bug Fix: Simplified positioning) -->
      <div class="absolute top-8 left-8 z-40">
        <img 
          src="/logos/MLBlogo2Transparent.png" 
          alt="Max Line Bulldogs Logo" 
          class="h-[55px] w-auto transition-all duration-500 hover:scale-110 hover:drop-shadow-lg"
          loading="eager"
        />
      </div>

      <!-- Partnership Note - Enhanced badge design (using dynamic content) -->
      <div class="absolute top-8 right-8 z-40">
        <div class="bg-gradient-to-r from-orange-100 via-white to-orange-100 text-orange-800 px-6 py-3 rounded-full text-sm font-semibold shadow-xl backdrop-blur-sm border border-orange-200/50 hover:scale-105 transition-all duration-300">
          {breedingProgram?.partnership_note || 'In partnership with HorrorBulz HQ ü§ù'}
        </div>
      </div>
      
      <!-- Background Media Container - Enhanced depth -->
      <div class="absolute inset-0 w-full h-full">
        
        {/* Video/Image Background - Enhanced with better overlay */}
        {backgroundVideo && videoUrl ? (
          <div class="video-container absolute inset-0 w-full h-full">
            <!-- Primary Video Element -->
            <video 
              id="hero-video"
              autoplay 
              loop 
              muted 
              playsinline 
              preload="metadata"
              crossorigin="anonymous"
              poster={videoPosterUrl || fallbackPosterUrl}
              class="hero-video w-full h-full object-cover"
              style="opacity: 0; transition: opacity 2s ease-in-out;"
              data-video-url={videoUrl}
              data-poster-url={videoPosterUrl}
            >
              <source src={videoUrl} type="video/mp4" />
              <source src={videoUrl.replace('.mp4', '.webm')} type="video/webm" />
              
              <!-- Fallback message -->
              <p class="text-white text-center">
                Your browser does not support video playback. 
                <a href={videoUrl} class="underline">Click here to view the video</a>
              </p>
            </video>
            
            <!-- Cloudinary Preview GIF as Loading Placeholder -->
            {videoPreviewUrl && (
              <div class="video-preview absolute inset-0 w-full h-full">
                <img 
                  src={videoPreviewUrl}
                  alt="Video Preview"
                  class="w-full h-full object-cover"
                  style="display: block; transition: opacity 1s ease-in-out;"
                  id="video-preview"
                />
              </div>
            )}
            
            <!-- Static Poster Fallback -->
            <div class="video-fallback absolute inset-0 w-full h-full bg-cover bg-center" 
                 style={`background-image: url('${videoPosterUrl || fallbackPosterUrl}');`}
                 id="video-fallback">
            </div>
          </div>
        ) : backgroundImage ? (
          <!-- Background Image from hero_media -->
          <div class="absolute inset-0 w-full h-full">
            <img 
              src={getImageUrl(backgroundImage, 'large')} 
              alt={backgroundImage.alternativeText || 'Max Line Bulldogs'} 
              class="w-full h-full object-cover"
            />
          </div>
        ) : (
          <!-- Enhanced gradient fallback with animated patterns -->
          <div class="absolute inset-0 bg-gradient-to-br from-amber-900 via-orange-800 to-red-900">
            <!-- Animated pattern overlay -->
            <div class="absolute inset-0 opacity-20 animated-pattern-overlay"></div>
          </div>
        )}
        
        <!-- Enhanced multi-layer gradient overlay -->
        <div class="absolute inset-0 bg-gradient-to-b from-black/40 via-black/10 to-black/60"></div>
        <div class="absolute inset-0 bg-gradient-to-r from-transparent via-black/5 to-transparent"></div>
      </div>
      
      <!-- üéØ ENHANCED CONTENT OVERLAY - Better positioning and typography -->
      <div class="relative z-20 text-center px-6 max-w-6xl mx-auto">
        
        <!-- Main Title - Enhanced with better shadow and sizing -->
        <h1 class="font-playfair text-5xl md:text-7xl xl:text-8xl font-black uppercase mb-8 text-white tracking-widest enhanced-hero-title-shadow animate-fade-in">
          {breedingProgram?.title || 'MAX LINE BULLDOGS'}
        </h1>
        
        <!-- Subtitle - Better spacing and styling -->
        <div class="text-2xl md:text-3xl text-white/95 mb-10 font-medium italic max-w-4xl mx-auto animate-fade-in-delay">
          <div set:html={processRichText(breedingProgram?.subtext) || '<h2>WHERE LEGENDS ARE MADE üèÜ</h2>'} />
        </div>
        
        <!-- Description - Better readability -->
        <div class="text-xl md:text-2xl text-white/90 max-w-5xl mx-auto leading-relaxed mb-16 font-inter animate-fade-in-delay-2">
          <div set:html={processRichText(breedingProgram?.description) || '<p>Pioneering premium English Bulldog breeding through strategic imports, exotic genetics, and cultural influence. üë®‚Äçü¶∫</p>'} />
        </div>

        <!-- Enhanced CTA buttons with better spacing -->
        <div class="flex flex-col sm:flex-row gap-6 justify-center items-center animate-fade-in-delay-3">
          <a href="/studs" class="group bg-gradient-to-r from-[#FF6B00] via-[#FF7F00] to-[#FF6B00] hover:from-[#E55A00] hover:via-[#F66A00] hover:to-[#E55A00] text-white px-10 py-5 rounded-full font-bold text-xl transition-all duration-500 hover:scale-110 hover:shadow-2xl shadow-xl flex items-center gap-4 bg-size-200 bg-pos-0 hover:bg-pos-100">
            <svg class="w-6 h-6 transition-transform duration-500 group-hover:rotate-12" fill="currentColor" viewBox="0 0 20 20">
              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
            </svg>
            View Our Champion Studs
          </a>
          <a href="/puppies" class="group border-3 border-white/70 text-white hover:bg-white/20 hover:border-white px-10 py-5 rounded-full font-bold text-xl transition-all duration-500 hover:scale-110 backdrop-blur-md flex items-center gap-4">
            <svg class="w-6 h-6 transition-transform duration-500 group-hover:bounce" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"/>
            </svg>
            Available Puppies
          </a>
        </div>
      </div>

      <!-- Enhanced video loading indicator -->
      <div id="video-loading" class="absolute top-20 left-1/2 transform -translate-x-1/2 z-30 bg-black/80 backdrop-blur-md text-white px-8 py-4 rounded-full text-sm font-semibold shadow-xl border border-white/30" style="display: none;">
        <div class="flex items-center gap-3">
          <div class="w-4 h-4 bg-gradient-to-r from-orange-400 to-orange-500 rounded-full animate-pulse"></div>
          üé• Loading Cinematic Experience...
        </div>
      </div>

      <!-- Enhanced scroll indicator with better animation -->
      <div class="absolute bottom-12 left-1/2 transform -translate-x-1/2 z-20">
        <div class="enhanced-bounce cursor-pointer" title="Discover our breeding philosophy">
          <div class="w-10 h-10 rounded-full bg-white/20 backdrop-blur-md flex items-center justify-center border-2 border-white/40 hover:bg-white/30 transition-all duration-300">
            <svg class="w-5 h-5 text-white/80" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
            </svg>
          </div>
        </div>
      </div>
    </section>

    <!-- Wave Divider Between Sections -->
    <div class="relative -mt-1">
      <svg viewBox="0 0 1440 60" class="w-full h-16 fill-white">
        <path d="M0,0L48,5.3C96,11,192,21,288,16C384,11,480,32,576,37.3C672,43,768,32,864,16C960,0,1056,22,1152,26.7C1248,32,1344,0,1392,16L1440,32L1440,60L1392,60C1344,60,1248,60,1152,60C1056,60,960,60,864,60C768,60,672,60,576,60C480,60,384,60,288,60C192,60,96,60,48,60L0,60Z" fill="#f9fafb"></path>
      </svg>
    </div>

    <!-- üéØ ENHANCED PHILOSOPHY SECTION - Tighter spacing, better flow -->
    <section class="py-12 lg:py-16 bg-white relative overflow-hidden">
      <!-- Enhanced decorative elements -->
      <div class="absolute top-0 left-0 w-96 h-96 bg-gradient-to-br from-orange-100/40 to-orange-200/20 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2"></div>
      <div class="absolute bottom-0 right-0 w-96 h-96 bg-gradient-to-tl from-blue-100/30 to-purple-100/20 rounded-full blur-3xl translate-x-1/2 translate-y-1/2"></div>
      
      <div class="max-w-7xl mx-auto px-4 md:px-8 relative">
        
        <!-- Section Header - Better spacing -->
        <div class="text-center mb-12 fade-in-scroll">
          <h2 class="font-playfair text-4xl md:text-6xl font-bold mb-6 bg-gradient-to-r from-gray-800 via-orange-600 to-gray-700 bg-clip-text text-transparent">
            üêæ Our Breeding Philosophy
          </h2>
          <div class="w-32 h-1.5 bg-gradient-to-r from-orange-400 via-orange-500 to-orange-600 mx-auto rounded-full"></div>
        </div>
        
        <!-- Enhanced Two-Column Layout with better visual balance -->
        <div class="grid lg:grid-cols-5 gap-8 lg:gap-12 items-center">
          
          <!-- 60% Text Content - Enhanced cards -->
          <div class="lg:col-span-3 fade-in-scroll delay-200">
            
            <!-- Main Philosophy Text -->
            <div class="prose prose-lg max-w-none font-inter mb-8">
              <div class="text-gray-700 leading-relaxed text-xl mb-6">
                <div set:html={processRichText(breedingProgram?.description) || 
                  '<p>Pioneering premium English Bulldog breeding through strategic imports, exotic genetics, and cultural influence. Our bloodlines represent the finest examples of champion heritage.</p>'} />
              </div>
              
              <!-- Detailed Philosophy -->
              <div class="text-gray-600 leading-relaxed text-lg space-y-4 mb-8">
                <p>{breedingProgram?.description_long || 'Our breeding program represents decades of dedication to the English Bulldog breed. We combine traditional breeding methods with modern genetic science to produce healthy, well-tempered bulldogs that embody the best of the breed standard.'}</p>
              </div>
            </div>
            
            <!-- Enhanced Key Promises Grid with better styling -->
            <div class="grid md:grid-cols-2 gap-3 mb-8">
              <div class="flex items-start gap-3 p-5 bg-gradient-to-r from-green-50 to-green-100/50 rounded-xl border-l-4 border-green-400 hover:shadow-lg transition-all duration-300 hover:-translate-y-1">
                <div class="w-10 h-10 bg-gradient-to-r from-green-400 to-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                  <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                  </svg>
                </div>
                <div>
                  <h4 class="font-playfair font-bold text-gray-800 mb-2">Health Clearances</h4>
                  <p class="text-sm text-gray-600 leading-relaxed">Comprehensive genetic testing for all breeding dogs</p>
                </div>
              </div>
              
              <div class="flex items-start gap-3 p-5 bg-gradient-to-r from-blue-50 to-blue-100/50 rounded-xl border-l-4 border-blue-400 hover:shadow-lg transition-all duration-300 hover:-translate-y-1">
                <div class="w-10 h-10 bg-gradient-to-r from-blue-400 to-blue-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                  <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"/>
                  </svg>
                </div>
                <div>
                  <h4 class="font-playfair font-bold text-gray-800 mb-2">Exceptional Temperament</h4>
                  <p class="text-sm text-gray-600 leading-relaxed">Gentle, family-friendly personalities</p>
                </div>
              </div>
              
              <div class="flex items-start gap-3 p-5 bg-gradient-to-r from-purple-50 to-purple-100/50 rounded-xl border-l-4 border-purple-400 hover:shadow-lg transition-all duration-300 hover:-translate-y-1">
                <div class="w-10 h-10 bg-gradient-to-r from-purple-400 to-purple-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                  <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                  </svg>
                </div>
                <div>
                  <h4 class="font-playfair font-bold text-gray-800 mb-2">Champion Bloodlines</h4>
                  <p class="text-sm text-gray-600 leading-relaxed">Finest genetic heritage from US and UK</p>
                </div>
              </div>
              
              <div class="flex items-start gap-3 p-5 bg-gradient-to-r from-orange-50 to-orange-100/50 rounded-xl border-l-4 border-orange-400 hover:shadow-lg transition-all duration-300 hover:-translate-y-1">
                <div class="w-10 h-10 bg-gradient-to-r from-orange-400 to-orange-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                  <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                  </svg>
                </div>
                <div>
                  <h4 class="font-playfair font-bold text-gray-800 mb-2">Lifetime Support</h4>
                  <p class="text-sm text-gray-600 leading-relaxed">Ongoing guidance for your bulldog's journey</p>
                </div>
              </div>
            </div>
            
            <!-- Enhanced "Our Family Promise" Callout Block -->
            <div class="bg-gradient-to-r from-orange-50 via-white to-blue-50 p-8 rounded-3xl border-l-4 border-orange-400 shadow-xl hover:shadow-2xl transition-all duration-500 hover:-translate-y-2">
              <div class="flex items-start gap-5">
                <div class="w-14 h-14 bg-gradient-to-r from-orange-400 to-orange-500 rounded-full flex items-center justify-center flex-shrink-0 shadow-lg">
                  <span class="text-3xl">ü§ù</span>
                </div>
                <div>
                  <h4 class="font-playfair font-bold text-2xl text-gray-800 mb-4">Our Family Promise</h4>
                  <p class="italic text-lg text-gray-700 leading-relaxed">"Every puppy we place comes with our lifelong commitment to both dog and family. We don't just breed bulldogs‚Äîwe build lasting relationships that span generations."</p>
                  <div class="mt-5 text-sm font-bold text-orange-700 flex items-center gap-2">
                    <span class="w-2 h-2 bg-orange-400 rounded-full"></span>
                    ‚Äî The Max Line Family
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 40% Enhanced Image Content with dramatic tilt -->
          <div class="lg:col-span-2 fade-in-scroll delay-400">
            <div class="relative">
              {galleryImages.length > 0 ? (
                <div class="transform -rotate-6 hover:rotate-0 transition-all duration-1000 hover:scale-105">
                  <div class="relative overflow-hidden rounded-3xl shadow-2xl hover:shadow-3xl transition-shadow duration-700">
                    <img 
                      src={getImageUrl(galleryImages[0], 'large')} 
                      alt={galleryImages[0].alternativeText || 'Max Line Bulldogs Philosophy'}
                      class="w-full h-[450px] object-cover transition-transform duration-1000 hover:scale-110"
                      loading="lazy"
                    />
                    <!-- Enhanced gradient overlay -->
                    <div class="absolute inset-0 bg-gradient-to-t from-black/30 via-transparent to-transparent"></div>
                    
                    <!-- Enhanced floating badge -->
                    <div class="absolute top-6 right-6 bg-gradient-to-r from-white/95 to-white/90 backdrop-blur-sm px-5 py-3 rounded-full text-sm font-bold text-gray-800 shadow-xl border border-white/40">
                      Est. 2010 ‚≠ê
                    </div>
                  </div>
                </div>
              ) : (
                <!-- Enhanced placeholder -->
                <div class="transform -rotate-6 hover:rotate-0 transition-all duration-1000 hover:scale-105">
                  <div class="relative overflow-hidden rounded-3xl shadow-2xl bg-gradient-to-br from-gray-200 to-gray-300 h-[450px] flex items-center justify-center">
                    <div class="text-center text-gray-500">
                      <div class="text-7xl mb-4">üêï</div>
                      <p class="text-xl font-bold">Philosophy Image</p>
                      <p class="text-sm">Coming Soon</p>
                    </div>
                  </div>
                </div>
              )}
              
              <!-- Enhanced decorative elements -->
              <div class="absolute -bottom-8 -left-8 w-32 h-32 bg-gradient-to-r from-orange-200/60 to-orange-300/40 rounded-full blur-2xl"></div>
              <div class="absolute -top-8 -right-8 w-40 h-40 bg-gradient-to-r from-blue-200/40 to-purple-200/30 rounded-full blur-2xl"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Another Wave Divider -->
    <div class="relative">
      <svg viewBox="0 0 1440 60" class="w-full h-16 fill-gradient-to-b from-white to-gray-50">
        <path d="M0,0L48,5.3C96,11,192,21,288,16C384,11,480,32,576,37.3C672,43,768,32,864,16C960,0,1056,22,1152,26.7C1248,32,1344,0,1392,16L1440,32L1440,60L1392,60C1344,60,1248,60,1152,60C1056,60,960,60,864,60C768,60,672,60,576,60C480,60,384,60,288,60C192,60,96,60,48,60L0,60Z" fill="#f9fafb"></path>
      </svg>
    </div>

    <!-- Conditionally Apply Horror Theme Based on partnership_theme_enabled -->
    {partnershipThemeEnabled ? (
      <!-- Black-to-Red Gradient Divider for Seamless Theme Transition -->
      <div class="bg-gradient-to-b from-black to-red-900 h-12 w-full relative">
        <div class="absolute inset-0 bg-gradient-to-r from-red-900/30 via-black to-red-900/30"></div>
      </div>

      <!-- üéØ HORRORBULLZ HQ THEMED SECTION - Black and Red Horror Theme -->
      <div class="horror-theme bg-black text-white relative overflow-hidden">
        <section class="py-12 relative overflow-hidden">
          <!-- Horror-themed background elements -->
          <div class="absolute top-10 right-10 w-80 h-80 bg-gradient-to-br from-red-900/40 to-red-800/20 rounded-full blur-3xl"></div>
          <div class="absolute bottom-10 left-10 w-96 h-96 bg-gradient-to-tr from-red-900/30 to-black/40 rounded-full blur-3xl"></div>
          
          <div class="max-w-7xl mx-auto px-4 md:px-8 relative">
            
            <!-- Gallery Header - Using dynamic partnership fields -->
            <div class="text-center mb-12 fade-in-scroll">
              <h2 class="text-5xl md:text-6xl font-playfair font-bold mb-6 bg-gradient-to-r from-red-500 via-red-600 to-red-700 bg-clip-text text-transparent">
                {partnershipGalleryTitle}
              </h2>
              <p class="text-xl text-red-100 max-w-4xl mx-auto leading-relaxed font-inter">
                {partnershipGalleryDescription}
              </p>
              <div class="mt-8">
                <div class="w-40 h-1.5 bg-gradient-to-r from-red-600 via-red-500 to-red-700 mx-auto rounded-full"></div>
              </div>
            </div>
          
            <!-- üéØ HORROR-THEMED FEATURED IMAGE SECTION - Using dynamic partnership fields -->
            {featuredImage ? (
              <div class="mb-16 fade-in-scroll delay-200">
                <div class="text-center mb-8">
                  <h3 class="text-3xl md:text-4xl font-playfair font-bold text-red-400 mb-4 flex items-center justify-center gap-4">
                    <span class="text-4xl animate-pulse text-red-500">üíÄ</span>
                    {partnershipFeaturedTitle}
                    <span class="text-4xl animate-pulse text-red-500">üíÄ</span>
                  </h3>
                </div>
                
                <!-- Horror-style full-width container with clickable modal functionality -->
                <div class="relative w-full max-w-6xl mx-auto group cursor-pointer modal-trigger" 
                     data-image-src={getImageUrl(featuredImage, 'large')} 
                     data-image-alt={featuredImage.alternativeText || 'Featured Max Line Bulldog'}>
                  <div class="relative h-[60vh] md:h-[70vh] rounded-3xl overflow-hidden border-2 border-red-600 shadow-2xl hover:shadow-red-800/50 transition-all duration-700 transform hover:scale-105">
                    <!-- Full coverage background image -->
                    <img 
                      src={getImageUrl(featuredImage, 'large')} 
                      alt={featuredImage.alternativeText || 'Featured Max Line Bulldog'}
                      class="absolute inset-0 w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110"
                      loading="lazy"
                      decoding="async"
                    />
                    
                    <!-- Horror-themed multi-layer overlay -->
                    <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-red-900/20 to-transparent"></div>
                    <div class="absolute inset-0 bg-gradient-to-r from-black/40 via-transparent to-black/40"></div>
                    
                    <!-- Centered overlay content - Using dynamic partnership fields -->
                    <div class="absolute inset-0 flex items-center justify-center">
                      <div class="text-center text-white px-8 py-12 max-w-4xl">
                        <!-- HorrorBullzHQ Branding -->
                        <h4 class="font-playfair font-black text-4xl md:text-7xl mb-6 uppercase tracking-wider horror-bullz-title-shadow">
                          {partnershipFeaturedMainTitle}
                        </h4>
                        <div class="text-lg md:text-xl mb-4 font-medium tracking-wide text-red-300">
                          {partnershipFeaturedBrandLine}
                        </div>
                        <p class="text-xl md:text-2xl leading-relaxed font-inter text-white/95 italic">
                          {partnershipFeaturedTagline}
                        </p>
                        <!-- Click indicator -->
                        <div class="mt-6 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                          <div class="inline-flex items-center gap-2 bg-red-600/80 backdrop-blur-sm px-4 py-2 rounded-full text-sm font-semibold border border-red-500/50">
                            üîç Click to View Full Size
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Horror-themed corner badge - Using dynamic brand name -->
                    <div class="absolute top-8 right-8 bg-gradient-to-r from-red-600 via-red-700 to-black text-white px-6 py-3 rounded-full text-sm font-bold shadow-xl border-2 border-red-500/50">
                      üíÄ {partnershipBrandName}
                    </div>
                    
                    <!-- Horror-themed info badge -->
                    <div class="absolute bottom-8 left-8">
                      <div class="bg-black/80 backdrop-blur-md rounded-2xl p-6 max-w-sm border border-red-600/50">
                        <div class="flex items-center gap-3 mb-3">
                          <div class="w-10 h-10 bg-gradient-to-r from-red-600 to-red-800 rounded-full flex items-center justify-center">
                            <span class="text-white text-lg font-bold">üíÄ</span>
                          </div>
                          <span class="font-bold text-red-400 text-lg">{partnershipBrandName} Legacy</span>
                        </div>
                        <p class="text-red-100 text-sm leading-relaxed">This legendary bulldog embodies the {partnershipBrandName} standard - exceptional genetics, championship bloodlines, and unmatched character.</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            ) : (
              <!-- Horror-themed empty state for featured image -->
              <div class="text-center mb-16 fade-in-scroll delay-200">
                <div class="bg-gradient-to-br from-red-900/20 via-black to-red-900/10 rounded-3xl p-16 max-w-4xl mx-auto border-2 border-dashed border-red-600/50 shadow-lg">
                  <div class="text-8xl mb-8 animate-pulse text-red-500">üíÄ</div>
                  <h3 class="text-3xl md:text-4xl font-playfair font-bold text-red-400 mb-6">Featured Champion Coming Soon</h3>
                  <p class="text-red-100 text-lg mb-6 leading-relaxed max-w-2xl mx-auto">Upload your champion bulldog's featured image in the Strapi admin panel to showcase your {partnershipBrandName} legend in this hero-style featured section!</p>
                  
                  <div class="bg-black/60 border border-red-600/50 rounded-2xl p-6 text-sm text-red-100 shadow-xl max-w-2xl mx-auto">
                    <div class="flex items-center gap-4 mb-6">
                      <div class="w-12 h-12 bg-gradient-to-r from-red-600 to-red-800 rounded-full flex items-center justify-center">
                        <span class="text-xl">üíÄ</span>
                      </div>
                      <p class="font-bold text-lg text-red-400">{partnershipBrandName} Setup Guide:</p>
                    </div>
                    <ol class="list-decimal list-inside space-y-3 text-left leading-relaxed">
                      <li>Go to your Strapi admin panel</li>
                      <li>Navigate to <strong>Content Manager</strong> ‚Üí <strong>Breeding Program</strong></li>
                      <li>Upload an image to the <strong>Featured_IMAGE</strong> field</li>
                      <li>Add descriptive alt text</li>
                      <li>Save and publish</li>
                    </ol>
                  </div>
                </div>
              </div>
            )}
          
            <!-- üéØ HORROR-THEMED MASONRY GALLERY GRID - Using dynamic partnership fields -->
            {galleryImages.length > 0 ? (
              <div class="fade-in-scroll delay-400">
                <div class="text-center mb-12">
                  <h3 class="text-3xl md:text-4xl font-playfair font-bold text-red-400 mb-6 flex items-center justify-center gap-4">
                    {partnershipHighlightsTitle}
                  </h3>
                  <p class="text-red-100 max-w-3xl mx-auto text-lg leading-relaxed">{partnershipHighlightsDescription}</p>
                </div>
                
                <!-- Horror-themed Masonry Grid with tighter spacing -->
                <div class="enhanced-masonry-grid gap-4 md:gap-6" id="masonry-container">
                  {masonryGalleryItems.map((image, index) => (
                    <div 
                      class={`enhanced-masonry-item modal-trigger group relative bg-black border-2 border-red-600 rounded-2xl overflow-hidden shadow-lg hover:shadow-red-800/50 transition-all duration-700 cursor-pointer ${image.cardHeight} hover:-translate-y-3 hover:rotate-1`}
                      data-aos="fade-up"
                      data-aos-delay={index * 150}
                      data-index={index + 1}
                      data-image-src={getImageUrl(image, 'large')}
                      data-image-alt={image.alternativeText || `Max Line Bulldogs Gallery Image ${index + 1}`}
                      tabindex="0"
                      role="button"
                      aria-label={`View ${image.alternativeText || `Gallery Image ${index + 1}`}`}
                    >
                      <!-- Horror-themed image container -->
                      <div class="relative overflow-hidden h-full">
                        <img 
                          src={getImageUrl(image, 'medium')} 
                          alt={image.alternativeText || `Max Line Bulldogs Gallery Image ${index + 1}`}
                          class="w-full h-full object-cover transition-all duration-1000 group-hover:scale-125 group-focus:scale-125"
                          loading="lazy"
                          decoding="async"
                          data-masonry-item
                        />
                        
                        <!-- Horror-themed gradient overlay -->
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-red-900/20 to-transparent opacity-0 group-hover:opacity-100 group-focus:opacity-100 transition-all duration-500"></div>
                        
                        <!-- Horror-themed content overlay -->
                        <div class="absolute inset-0 flex flex-col justify-end p-6 opacity-0 group-hover:opacity-100 group-focus:opacity-100 transition-all duration-500 transform translate-y-6 group-hover:translate-y-0 group-focus:translate-y-0">
                          <div class="text-white">
                            <h4 class="font-playfair font-bold text-xl mb-3 line-clamp-2">
                              {image.alternativeText || `Gallery Image ${index + 1}`}
                            </h4>
                            <div class="flex items-center justify-between">
                              <div class="flex items-center gap-2">
                                <div class="w-8 h-8 bg-gradient-to-r from-red-600 to-red-800 rounded-full flex items-center justify-center">
                                  <span class="text-white text-sm font-bold">üíÄ</span>
                                </div>
                                <span class="text-sm font-semibold">{partnershipBrandName}</span>
                              </div>
                              <div class="text-xs font-bold bg-red-600/80 backdrop-blur-sm px-2 py-1.5 rounded-full border border-red-500/50">
                                üîç View Full Size
                              </div>
                            </div>
                          </div>
                        </div>
                        
                        <!-- Horror-themed numbered badge -->
                        <div class="absolute top-4 right-4 bg-gradient-to-r from-red-600/90 to-red-800/90 backdrop-blur-sm text-white text-sm px-4 py-2 rounded-full font-bold shadow-lg border border-red-500/50 transition-all duration-300 group-hover:scale-110">
                          üíÄ #{(index + 1).toString().padStart(2, '0')}
                        </div>
                        
                        <!-- Horror-themed focus ring -->
                        <div class="absolute inset-0 ring-4 ring-red-600 ring-opacity-0 group-focus:ring-opacity-100 rounded-2xl transition-all duration-300"></div>
                      </div>
                    </div>
                  ))}
                </div>
                
                <!-- Horror-themed load more button - Using dynamic coming soon message -->
                <div class="text-center mt-16">
                  <button class="bg-gradient-to-r from-red-600 via-red-700 to-red-800 hover:from-red-700 hover:via-red-800 hover:to-red-900 text-white px-12 py-5 rounded-full font-bold text-xl transition-all duration-500 hover:scale-105 shadow-xl hover:shadow-red-800/50 disabled:opacity-75 disabled:cursor-not-allowed border border-red-500/50 animate-pulse" disabled>
                    <span class="flex items-center gap-4">
                      {partnershipComingSoonMessage}
                    </span>
                  </button>
                </div>
              </div>
            ) : (
              <!-- Horror-themed empty state for gallery -->
              <div class="text-center py-20 fade-in-scroll delay-400">
                <div class="bg-gradient-to-br from-red-900/20 via-black to-red-900/10 rounded-3xl p-16 max-w-4xl mx-auto border-2 border-dashed border-red-600/50 shadow-lg">
                  <div class="text-9xl mb-8 animate-pulse text-red-500">üíÄ</div>
                  <h3 class="text-4xl md:text-5xl font-playfair font-bold text-red-400 mb-6">{partnershipBrandName} Gallery Coming Soon</h3>
                  <p class="text-red-100 text-xl md:text-2xl mb-10 leading-relaxed max-w-3xl mx-auto">
                    Our legendary {partnershipBrandName} gallery will appear here once photos are uploaded to the Photo Gallery field in Strapi.
                  </p>
                </div>
              </div>
            )}
            
            <!-- Horror-themed Family Values Section - Using dynamic partnership fields -->
            <div class="mt-20 fade-in-scroll delay-400">
              <div class="bg-gradient-to-r from-red-900/30 via-black to-red-900/20 rounded-3xl p-12 md:p-16 text-center border border-red-600/50 shadow-2xl relative overflow-hidden">
                <!-- Horror-themed decorative elements -->
                <div class="absolute top-0 left-0 w-40 h-40 bg-gradient-to-r from-red-900/40 to-red-800/30 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2"></div>
                <div class="absolute bottom-0 right-0 w-40 h-40 bg-gradient-to-r from-red-800/40 to-black/30 rounded-full blur-3xl translate-x-1/2 translate-y-1/2"></div>
                
                <div class="relative">
                  <div class="flex justify-center mb-12">
                    <div class="flex items-center gap-8">
                      <div class="w-20 h-20 bg-gradient-to-r from-red-600 to-red-800 rounded-full flex items-center justify-center enhanced-family-icon shadow-xl border-2 border-red-500/50">
                        <span class="text-4xl">üíÄ</span>
                      </div>
                      <div class="w-20 h-20 bg-gradient-to-r from-red-700 to-black rounded-full flex items-center justify-center enhanced-family-icon shadow-xl border-2 border-red-600/50">
                        <span class="text-4xl">üñ§</span>
                      </div>
                      <div class="w-20 h-20 bg-gradient-to-r from-black to-red-800 rounded-full flex items-center justify-center enhanced-family-icon shadow-xl border-2 border-red-700/50">
                        <span class="text-4xl">üêï</span>
                      </div>
                    </div>
                  </div>
                  <h3 class="text-4xl md:text-5xl font-playfair font-bold text-red-400 mb-8">{partnershipLegacyTitle}</h3>
                  <div class="text-xl md:text-2xl text-red-100 max-w-4xl mx-auto leading-relaxed font-inter mb-12">
                    <div set:html={partnershipLegacyDescription} />
                  </div>
                  
                  <!-- Horror-themed call to action buttons -->
                  <div class="flex flex-col sm:flex-row gap-6 justify-center items-center">
                    <a href="/studs" class="group bg-gradient-to-r from-red-600 via-red-700 to-red-800 hover:from-red-700 hover:via-red-800 hover:to-red-900 text-white px-12 py-5 rounded-full font-bold text-xl transition-all duration-500 hover:scale-110 shadow-xl hover:shadow-red-800/50 flex items-center gap-4 border border-red-500/50">
                      üíÄ
                      Meet Our Champion Studs
                    </a>
                    <a href="/puppies" class="group border-3 border-red-600 text-red-400 hover:bg-red-900/30 hover:border-red-500 px-12 py-5 rounded-full font-bold text-xl transition-all duration-500 hover:scale-110 backdrop-blur-sm flex items-center gap-4 shadow-lg hover:shadow-red-800/50">
                      üíÄ
                      Available Puppies
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>
    ) : (
      <!-- Alternative light theme section when partnership_theme_enabled is false -->
      <section class="py-12 lg:py-16 bg-gradient-to-b from-gray-50 to-white relative overflow-hidden">
        <div class="max-w-7xl mx-auto px-4 md:px-8 relative">
          <!-- Light theme gallery header -->
          <div class="text-center mb-12 fade-in-scroll">
            <h2 class="text-5xl md:text-6xl font-playfair font-bold mb-6 bg-gradient-to-r from-orange-600 via-orange-500 to-orange-700 bg-clip-text text-transparent">
              {partnershipGalleryTitle.replace(/üíÄ/g, 'üèÜ')}
            </h2>
            <p class="text-xl text-gray-700 max-w-4xl mx-auto leading-relaxed font-inter">
              {partnershipGalleryDescription}
            </p>
            <div class="mt-8">
              <div class="w-40 h-1.5 bg-gradient-to-r from-orange-400 via-orange-500 to-orange-600 mx-auto rounded-full"></div>
            </div>
          </div>

          <!-- Light theme gallery content would go here -->
          <div class="text-center py-20">
            <div class="text-gray-600 text-lg">Light theme gallery content - Theme disabled in admin panel</div>
          </div>
        </div>
      </section>
    )}
    
    <!-- üöÄ FIXED: Enhanced Image Modal with Better Cross-Browser Support -->
    <div id="image-modal" class="modal-overlay" style="display: none;">
      <div class="modal-container">
        <!-- Close Button -->
        <button id="close-modal" class="modal-close-btn" type="button" aria-label="Close modal">
          <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
        
        <!-- Loading Spinner -->
        <div id="modal-loading" class="modal-loading">
          <div class="loading-spinner"></div>
          <p class="text-white text-center mt-4">Loading image...</p>
        </div>
        
        <!-- Modal Image -->
        <img id="modal-image" class="modal-image" alt="" />
        
        <!-- Image Info -->
        <div id="modal-info" class="modal-info">
          <div class="flex items-center gap-3 mb-2">
            <div class="w-8 h-8 bg-gradient-to-r from-red-600 to-red-800 rounded-full flex items-center justify-center">
              <span class="text-white text-sm font-bold">üíÄ</span>
            </div>
            <span class="font-bold text-red-400 text-lg">{partnershipBrandName}</span>
          </div>
          <p id="modal-caption" class="text-red-100 text-sm"></p>
        </div>
        
        <!-- Navigation Buttons -->
        <button id="modal-prev" class="modal-nav-btn modal-prev" type="button" aria-label="Previous image">
          <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
        </button>
        <button id="modal-next" class="modal-nav-btn modal-next" type="button" aria-label="Next image">
          <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </button>
      </div>
    </div>

    <!-- Development Status (only show if using fallback) -->
    {error && (
      <section class="max-w-6xl mx-auto px-4 md:px-8 py-8">
        <div class="bg-blue-50 border border-blue-200 rounded-2xl p-6 md:p-8">
          <div class="flex items-start gap-4">
            <div class="flex-shrink-0 mt-1">
              <svg class="h-6 w-6 text-blue-500" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
              </svg>
            </div>
            <div class="flex-1">
              <h3 class="text-xl font-bold text-blue-900 mb-3">üåê Connect to Strapi</h3>
              <p class="text-blue-800 mb-4 leading-relaxed">
                This page is showing fallback content. To display your live content:
              </p>
              <ol class="list-decimal list-inside text-blue-700 space-y-2 text-sm leading-relaxed">
                <li>Upload a video to the <strong>hero_media</strong> field for the background</li>
                <li>Upload images to the <strong>photo_gallery</strong> field for the gallery</li>
                <li>Update the content fields in your Strapi admin panel</li>
                <li>Save and publish your changes</li>
              </ol>
            </div>
          </div>
        </div>
      </section>
    )}

  </main>
</Layout>

<script>
  // üöÄ COMPREHENSIVE PHOTO GALLERY MODAL FUNCTIONALITY - FIXED
  document.addEventListener('DOMContentLoaded', function() {
    console.log('üéØ Initializing photo gallery modal...');
    
    // Modal elements with proper type casting
    const modal = document.getElementById('image-modal') as HTMLElement | null;
    const modalImage = document.getElementById('modal-image') as HTMLImageElement | null;
    const modalCaption = document.getElementById('modal-caption') as HTMLElement | null;
    const modalLoading = document.getElementById('modal-loading') as HTMLElement | null;
    const closeButton = document.getElementById('close-modal') as HTMLButtonElement | null;
    const prevButton = document.getElementById('modal-prev') as HTMLButtonElement | null;
    const nextButton = document.getElementById('modal-next') as HTMLButtonElement | null;
    
    // Track current gallery and index for navigation
    let currentImages: Array<{src: string, alt: string, trigger: Element}> = [];
    let currentIndex = 0;
    
    // Ensure modal is closed on load
    if (modal) {
      modal.style.display = 'none';
      document.body.style.overflow = 'auto';
    }
    
    // Collect all gallery images for navigation
    function updateImageCollection() {
      const galleryImages = document.querySelectorAll('.modal-trigger');
      currentImages = Array.from(galleryImages).map(trigger => ({
        src: trigger.getAttribute('data-image-src') || (trigger.querySelector('img') as HTMLImageElement)?.src || '',
        alt: trigger.getAttribute('data-image-alt') || (trigger.querySelector('img') as HTMLImageElement)?.alt || '',
        trigger: trigger
      })).filter(img => img.src);
      console.log('üì∏ Found gallery images:', currentImages.length);
    }
    
    // Show loading state
    function showLoading() {
      if (modalLoading) modalLoading.style.display = 'flex';
      if (modalImage) modalImage.style.display = 'none';
    }
    
    // Hide loading state
    function hideLoading() {
      if (modalLoading) modalLoading.style.display = 'none';
      if (modalImage) modalImage.style.display = 'block';
    }
    
    // Open modal with image
    function openModal(imageSrc: string, caption: string = '', index: number = 0) {
      if (!modal || !modalImage) {
        console.error('‚ùå Modal elements not found');
        return;
      }
      
      console.log('üñºÔ∏è Opening modal with:', imageSrc);
      
      currentIndex = index;
      showLoading();
      
      // Show modal
      modal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
      
      // Create new image to preload
      const img = new Image();
      img.onload = function() {
        if (modalImage) {
          modalImage.src = imageSrc;
          modalImage.alt = caption;
        }
        if (modalCaption) modalCaption.textContent = caption;
        hideLoading();
        
        // Update navigation buttons
        updateNavigationButtons();
        
        console.log('‚úÖ Modal image loaded successfully');
      };
      img.onerror = function() {
        console.error('‚ùå Failed to load image:', imageSrc);
        hideLoading();
        if (modalImage) modalImage.src = '';
        if (modalCaption) modalCaption.textContent = 'Failed to load image';
      };
      img.src = imageSrc;
    }
    
    // Close modal
    function closeModal() {
      if (!modal) return;
      
      console.log('üö™ Closing modal');
      modal.style.display = 'none';
      document.body.style.overflow = 'auto';
      
      // Clear image
      if (modalImage) {
        modalImage.src = '';
        modalImage.alt = '';
      }
      if (modalCaption) modalCaption.textContent = '';
    }
    
    // Update navigation button states
    function updateNavigationButtons() {
      if (prevButton) {
        prevButton.style.display = currentImages.length > 1 ? 'flex' : 'none';
        prevButton.disabled = currentIndex <= 0;
      }
      if (nextButton) {
        nextButton.style.display = currentImages.length > 1 ? 'flex' : 'none';
        nextButton.disabled = currentIndex >= currentImages.length - 1;
      }
    }
    
    // Navigate to previous image
    function showPrevImage() {
      if (currentIndex > 0) {
        currentIndex--;
        const prevImg = currentImages[currentIndex];
        openModal(prevImg.src, prevImg.alt, currentIndex);
      }
    }
    
    // Navigate to next image
    function showNextImage() {
      if (currentIndex < currentImages.length - 1) {
        currentIndex++;
        const nextImg = currentImages[currentIndex];
        openModal(nextImg.src, nextImg.alt, currentIndex);
      }
    }
    
    // Initialize image collection
    updateImageCollection();
    
    // Add click handlers to all modal triggers
    document.addEventListener('click', function(e) {
      if (!e.target) return;
      const trigger = (e.target as HTMLElement).closest('.modal-trigger');
      if (trigger) {
        e.preventDefault();
        e.stopPropagation();
        
        const imageSrc = trigger.getAttribute('data-image-src') || (trigger.querySelector('img') as HTMLImageElement)?.src;
        const caption = trigger.getAttribute('data-image-alt') || (trigger.querySelector('img') as HTMLImageElement)?.alt || '';
        
        if (imageSrc) {
          // Find index in current collection
          const index = currentImages.findIndex(img => img.src === imageSrc);
          openModal(imageSrc, caption, Math.max(0, index));
        }
      }
    });
    
    // Close button handler
    if (closeButton) {
      closeButton.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        closeModal();
      });
    }
    
    // Navigation button handlers
    if (prevButton) {
      prevButton.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        showPrevImage();
      });
    }
    
    if (nextButton) {
      nextButton.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        showNextImage();
      });
    }
    
    // Close on backdrop click
    if (modal) {
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          closeModal();
        }
      });
    }
    
    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
      if (modal && modal.style.display !== 'none') {
        switch(e.key) {
          case 'Escape':
            e.preventDefault();
            closeModal();
            break;
          case 'ArrowLeft':
            e.preventDefault();
            showPrevImage();
            break;
          case 'ArrowRight':
            e.preventDefault();
            showNextImage();
            break;
        }
      }
    });
    
    // Handle dynamic content updates
    const observer = new MutationObserver(function(mutations) {
      let shouldUpdate = false;
      mutations.forEach(function(mutation) {
        if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
          shouldUpdate = true;
        }
      });
      if (shouldUpdate) {
        updateImageCollection();
      }
    });
    
    // Observe changes to the gallery container
    const galleryContainer = document.getElementById('masonry-container');
    if (galleryContainer) {
      observer.observe(galleryContainer, { childList: true, subtree: true });
    }
    
    console.log('‚úÖ Photo gallery modal initialized successfully');
  });
</script>

<style>
  /* üöÄ ENHANCED MODAL STYLES - Cross-browser Compatible */
  .modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.95);
    backdrop-filter: blur(8px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    opacity: 0;
    transition: opacity 0.3s ease;
  }
  
  .modal-overlay[style*="flex"] {
    opacity: 1;
  }
  
  .modal-container {
    position: relative;
    max-width: 95vw;
    max-height: 95vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
  }
  
  .modal-image {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    border-radius: 12px;
    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
    border: 3px solid rgba(220, 38, 38, 0.5);
    display: none;
    transition: transform 0.3s ease;
  }
  
  .modal-image:hover {
    transform: scale(1.02);
  }
  
  .modal-close-btn {
    position: absolute;
    top: 20px;
    right: 20px;
    z-index: 10;
    background: linear-gradient(135deg, #dc2626, #b91c1c);
    color: white;
    width: 48px;
    height: 48px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid rgba(220, 38, 38, 0.5);
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  }
  
  .modal-close-btn:hover {
    background: linear-gradient(135deg, #b91c1c, #991b1b);
    transform: scale(1.1) rotate(90deg);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
  }
  
  .modal-info {
    position: absolute;
    bottom: 20px;
    left: 20px;
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(8px);
    border-radius: 16px;
    padding: 16px;
    max-width: 300px;
    border: 1px solid rgba(220, 38, 38, 0.3);
  }
  
  .modal-nav-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: linear-gradient(135deg, #dc2626, #b91c1c);
    color: white;
    width: 56px;
    height: 56px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid rgba(220, 38, 38, 0.5);
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    opacity: 0.8;
  }
  
  .modal-nav-btn:hover {
    background: linear-gradient(135deg, #b91c1c, #991b1b);
    transform: translateY(-50%) scale(1.1);
    opacity: 1;
  }
  
  .modal-nav-btn:disabled {
    opacity: 0.3;
    cursor: not-allowed;
    transform: translateY(-50%);
  }
  
  .modal-prev {
    left: 20px;
  }
  
  .modal-next {
    right: 20px;
  }
  
  .modal-loading {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 12px;
  }
  
  .loading-spinner {
    width: 48px;
    height: 48px;
    border: 4px solid rgba(220, 38, 38, 0.3);
    border-top: 4px solid #dc2626;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }
  
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  
  /* Horror Theme Specific Styles */
  .horror-theme {
    background: linear-gradient(135deg, #000000 0%, #1a0000 50%, #000000 100%);
    position: relative;
  }

  .horror-theme::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
      radial-gradient(circle at 20% 50%, rgba(255, 0, 0, 0.1) 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, rgba(139, 0, 0, 0.1) 0%, transparent 50%),
      radial-gradient(circle at 40% 80%, rgba(255, 0, 0, 0.05) 0%, transparent 50%);
    pointer-events: none;
  }

  .horror-title {
    font-family: 'Cinzel', 'Playfair Display', serif;
    text-shadow: 
      0 0 10px rgba(255, 0, 0, 0.5),
      0 0 20px rgba(255, 0, 0, 0.3),
      0 0 30px rgba(255, 0, 0, 0.1);
    letter-spacing: 2px;
  }

  /* Enhanced Gallery Hover Effects */
  .modal-trigger {
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .modal-trigger:hover {
    transform: translateY(-2px);
    filter: brightness(1.1);
  }

  .modal-trigger:focus {
    outline: 3px solid rgba(220, 38, 38, 0.5);
    outline-offset: 2px;
  }

  /* Fade in scroll animations */
  .fade-in-scroll {
    opacity: 0;
    transform: translateY(30px);
    animation: fadeInUp 0.8s ease forwards;
  }

  .delay-200 { animation-delay: 0.2s; }
  .delay-400 { animation-delay: 0.4s; }
  .delay-600 { animation-delay: 0.6s; }

  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Enhanced Masonry Grid */
  .enhanced-masonry-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    grid-gap: 1.5rem;
    align-items: start;
  }

  @media (min-width: 768px) {
    .enhanced-masonry-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 1024px) {
    .enhanced-masonry-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  @media (min-width: 1280px) {
    .enhanced-masonry-grid {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  /* Responsive Modal */
  @media (max-width: 768px) {
    .modal-container {
      padding: 10px;
    }
    
    .modal-close-btn {
      width: 40px;
      height: 40px;
      top: 10px;
      right: 10px;
    }
    
    .modal-nav-btn {
      width: 48px;
      height: 48px;
    }
    
    .modal-info {
      bottom: 10px;
      left: 10px;
      right: 10px;
      max-width: none;
    }
  }

  /* Light theme overrides */
  .light-theme {
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #f1f5f9 100%);
  }

  .light-theme .horror-title {
    color: #1e293b;
    text-shadow: none;
  }
</style>

